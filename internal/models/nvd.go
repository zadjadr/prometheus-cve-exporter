package models

// NVDFeed represents the top-level structure of the NVD CVE feed
type NVDFeed struct {
	CVEDataType         string    `json:"CVE_data_type"`
	CVEDataFormat       string    `json:"CVE_data_format"`
	CVEDataVersion      string    `json:"CVE_data_version"`
	CVEDataNumberOfCVEs string    `json:"CVE_data_numberOfCVEs"`
	CVEDataTimestamp    string    `json:"CVE_data_timestamp"`
	CVEItems            []CVEItem `json:"CVE_Items"`
}

// CVEItem represents a single CVE item in the feed
type CVEItem struct {
	CVE              CVE            `json:"cve"`
	Configurations   Configurations `json:"configurations"`
	Impact           Impact         `json:"impact"`
	PublishedDate    string         `json:"publishedDate"`
	LastModifiedDate string         `json:"lastModifiedDate"`
}

// CVE represents the CVE data (this is a placeholder, as the full CVE structure is defined in a separate schema)
type CVE struct {
	CVEDataMeta CVEDataMeta `json:"CVE_data_meta"`
	// Other fields would be defined here based on the CVE_JSON_4.0_min_1.1.schema
}

// CVEDataMeta contains metadata about the CVE
type CVEDataMeta struct {
	ID string `json:"ID"`
}

// Configurations defines the set of product configurations for a NVD applicability statement
type Configurations struct {
	CVEDataVersion string `json:"CVE_data_version"`
	Nodes          []Node `json:"nodes"`
}

// Node defines a node or sub-node in an NVD applicability statement
type Node struct {
	Operator string     `json:"operator"`
	Negate   *bool      `json:"negate,omitempty"`
	Children []Node     `json:"children,omitempty"`
	CPEMatch []CPEMatch `json:"cpe_match,omitempty"`
}

// CPEMatch represents CPE match string or range
type CPEMatch struct {
	Vulnerable            bool      `json:"vulnerable"`
	CPE22Uri              string    `json:"cpe22Uri,omitempty"`
	CPE23Uri              string    `json:"cpe23Uri"`
	VersionStartExcluding string    `json:"versionStartExcluding,omitempty"`
	VersionStartIncluding string    `json:"versionStartIncluding,omitempty"`
	VersionEndExcluding   string    `json:"versionEndExcluding,omitempty"`
	VersionEndIncluding   string    `json:"versionEndIncluding,omitempty"`
	CPEName               []CPEName `json:"cpe_name,omitempty"`
}

// CPEName represents a CPE name
type CPEName struct {
	CPE22Uri         string `json:"cpe22Uri,omitempty"`
	CPE23Uri         string `json:"cpe23Uri"`
	LastModifiedDate string `json:"lastModifiedDate,omitempty"`
}

// Impact represents the impact scores for a vulnerability
type Impact struct {
	BaseMetricV3 *BaseMetricV3 `json:"baseMetricV3,omitempty"`
	BaseMetricV2 *BaseMetricV2 `json:"baseMetricV2,omitempty"`
}

// BaseMetricV3 represents CVSS V3.x score
type BaseMetricV3 struct {
	CVSSV3              CVSSV3  `json:"cvssV3"`
	ExploitabilityScore float64 `json:"exploitabilityScore"`
	ImpactScore         float64 `json:"impactScore"`
}

// CVSSV3 represents CVSS V3.x score details (this is a placeholder, as the full structure is defined in a separate schema)
type CVSSV3 struct {
	BaseScore    float64 `json:"baseScore"`
	BaseSeverity string  `json:"baseSeverity"`
}

// BaseMetricV2 represents CVSS V2.0 score
type BaseMetricV2 struct {
	CVSSV2                  CVSSV2  `json:"cvssV2"`
	Severity                string  `json:"severity"`
	ExploitabilityScore     float64 `json:"exploitabilityScore"`
	ImpactScore             float64 `json:"impactScore"`
	AcInsufInfo             bool    `json:"acInsufInfo"`
	ObtainAllPrivilege      bool    `json:"obtainAllPrivilege"`
	ObtainUserPrivilege     bool    `json:"obtainUserPrivilege"`
	ObtainOtherPrivilege    bool    `json:"obtainOtherPrivilege"`
	UserInteractionRequired bool    `json:"userInteractionRequired"`
}

// CVSSV2 represents CVSS V2.0 score details (this is a placeholder, as the full structure is defined in a separate schema)
type CVSSV2 struct {
	BaseScore float64 `json:"baseScore"`
	// Other fields would be defined here based on the cvss-v2.0.json schema
}
